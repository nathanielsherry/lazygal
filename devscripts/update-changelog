#!/bin/bash
# Small script to easily generate a ChangeLog from hg log.

project=Lazygal

HG=$(which hg)
AWK=$(which awk)

repo=$(dirname $0)/..

$HG log -R $repo |\
    $AWK -F':\ \ +'\
        '/^summary/ {if($2 !~ /^Added\ tag\ .+\ for\ changeset/ )\
                        print "  * " $2\
                    }\
         /^tag/     {gsub(/\_/,".");\
                     if( $2 !~ /tip/ ) print "\nLazygal " $2
                    }'\
    > $repo/ChangeLog
